From 0166a52395c7916e619e8e1c27b834c272118ec4 Mon Sep 17 00:00:00 2001
From: lhelontra <lhe.lontra@gmail.com>
Date: Wed, 2 Oct 2019 19:47:54 -0300
Subject: [PATCH] expose tflite SetNumThreads

---
 tensorflow/lite/python/interpreter.py                        | 3 +++
 .../lite/python/interpreter_wrapper/interpreter_wrapper.cc   | 5 +++++
 .../lite/python/interpreter_wrapper/interpreter_wrapper.h    | 1 +
 3 files changed, 9 insertions(+)

diff --git a/tensorflow/lite/python/interpreter.py b/tensorflow/lite/python/interpreter.py
index 0515bd5e42..29217db41b 100644
--- a/tensorflow/lite/python/interpreter.py
+++ b/tensorflow/lite/python/interpreter.py
@@ -455,6 +455,9 @@ class Interpreter(object):

   def reset_all_variables(self):
     return self._interpreter.ResetVariableTensors()
+
+  def set_num_threads(self, i):
+    return self._interpreter.SetNumThreads(i)


 class InterpreterWithCustomOps(Interpreter):
diff --git a/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.cc b/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.cc
index b4da1fd6d3..ad5a375abb 100644
--- a/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.cc
+++ b/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.cc
@@ -502,6 +502,11 @@ PyObject* InterpreterWrapper::ResetVariableTensors() {
   Py_RETURN_NONE;
 }

+PyObject* InterpreterWrapper::SetNumThreads(int i) {
+  interpreter_->SetNumThreads(i);
+  Py_RETURN_NONE;
+}
+
 PyObject* InterpreterWrapper::ModifyGraphWithDelegate(
     TfLiteDelegate* delegate) {
   TFLITE_PY_ENSURE_VALID_INTERPRETER();
diff --git a/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.h b/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.h
index de57f73203..6803d308bb 100644
--- a/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.h
+++ b/tensorflow/lite/python/interpreter_wrapper/interpreter_wrapper.h
@@ -75,6 +75,7 @@ class InterpreterWrapper {
   // Returns a reference to tensor index i as a numpy array. The base_object
   // should be the interpreter object providing the memory.
   PyObject* tensor(PyObject* base_object, int i);
+  PyObject* SetNumThreads(int i);

   // Adds a delegate to the interpreter.
   PyObject* ModifyGraphWithDelegate(TfLiteDelegate* delegate);
--
2.20.1
